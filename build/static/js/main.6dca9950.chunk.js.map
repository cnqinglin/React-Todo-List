{"version":3,"sources":["TodoInput.js","TodoItem.js","leanCloud.js","ForgotPasswordForm.js","SignUpForm.js","SignInForm.js","SignInOrSignUp.js","UserDialog.js","App.js","index.js"],"names":["submit","props","e","key","target","value","trim","onSubmit","changeTitle","onChange","type","content","className","bind","onKeyPress","TodoItem","checked","this","todo","status","toggle","title","onClick","delete","onToggle","onDelete","Component","AV","init","appId","appKey","TodoModel","getByUser","user","successFn","errorFn","query","Query","equalTo","find","then","response","array","map","t","id","attributes","call","error","create","deleted","Object","extend","set","acl","ACL","setPublicReadAccess","setWriteAccess","User","current","setReadAccess","setACL","save","update","createWithoutData","undefined","destroy","todoId","getCurrentUser","getUserFromAVUser","AVUser","ForgotPasswordForm","formData","email","href","onSignIn","username","password","onForgotPassword","SignInOrSignUp","state","selected","setState","switch","SignUpForm","onSignUp","SignInForm","UserDialog","selectedTab","preventDefault","setUsername","setPassword","setEmail","signUp","loginedUser","code","alert","logIn","signIn","stateCopy","JSON","parse","stringify","changeFormData","showForgotPassword","resetPassword","returnToSignIn","requestPasswordReset","success","App","newTodo","todoList","todos","filter","item","index","signOut","addTodo","onSignUpOrSignIn","logOut","oldStatus","event","push","console","log","React","div","document","getElementById","ReactDOM","render"],"mappings":"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","file":"static/js/main.6dca9950.chunk.js","sourcesContent":["import React from 'react';\r\nimport './TodoInput.css';\r\n\r\nfunction submit (props, e) {\r\n  if (e.key === 'Enter') {\r\n    if (e.target.value.trim() !== '') {\r\n      props.onSubmit(e)\r\n    }\r\n  }\r\n}\r\nfunction changeTitle (props, e) {\r\n  props.onChange(e)\r\n}\r\n\r\n// 搞不清楚 bind 用法的同学，请看完 MDN\r\n// https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Function/bind\r\n// 尤其是示例要看懂\r\n\r\nexport default function (props) {\r\n  return <input type=\"text\" value={props.content}\r\n    className=\"TodoInput\"\r\n    onChange={changeTitle.bind(null, props)}\r\n    onKeyPress={submit.bind(null, props)}/>\r\n}\r\n","import React, { Component } from 'react';\r\nimport './TodoItem.css';\r\n\r\nexport default class TodoItem extends Component {\r\n  render(){\r\n    return (\r\n      <div className=\"TodoItem\">\r\n        <input type=\"checkbox\" checked={this.props.todo.status === 'completed'}\r\n          onChange={this.toggle.bind(this)}/>\r\n        <span className=\"title\">{this.props.todo.title}</span>\r\n        <button onClick={this.delete.bind(this)}>删除</button>\r\n      </div>\r\n    )\r\n  }\r\n  toggle(e){\r\n    this.props.onToggle(e, this.props.todo)\r\n  }\r\n  delete(e){\r\n    this.props.onDelete(e, this.props.todo)\r\n  }\r\n}","import AV from 'leancloud-storage'\r\n\r\nvar APP_ID = \"pk0vzR4lHpYNoVUJhuV1L71I-9Nh9j0Va\";\r\nvar APP_KEY = \"1fDDSPbetyosgjESkfoEaO64\";\r\nAV.init({\r\n  appId: APP_ID,\r\n  appKey: APP_KEY\r\n})\r\n\r\nexport default AV\r\n\r\n// 所有跟 Todo 相关的 LeanCloud 操作都放到这里\r\nexport const TodoModel = {\r\n    getByUser(user, successFn, errorFn){\r\n      // 文档见 https://leancloud.cn/docs/leanstorage_guide-js.html#批量操作\r\n      let query = new AV.Query('Todo')\r\n      query.equalTo('deleted', false);\r\n      query.find().then((response) => {\r\n        let array = response.map((t) => {\r\n          return {id: t.id, ...t.attributes}\r\n        })\r\n        successFn.call(null, array)\r\n      }, (error) => {\r\n        errorFn && errorFn.call(null, error)\r\n      })\r\n    },\r\n    create({status, title, deleted}, successFn, errorFn){\r\n      let Todo = AV.Object.extend('Todo') // 记得把多余的分号删掉，我讨厌分号\r\n      let todo = new Todo()\r\n      todo.set('title', title)\r\n      todo.set('status', status)\r\n      todo.set('deleted', deleted)\r\n  \r\n      // 根据文档 https://leancloud.cn/docs/acl-guide.html#单用户权限设置\r\n      // 这样做就可以让这个 Todo 只被当前用户看到\r\n      let acl = new AV.ACL()\r\n      acl.setPublicReadAccess(false) // 注意这里是 false\r\n      acl.setWriteAccess(AV.User.current(), true)\r\n      acl.setReadAccess(AV.User.current(), true)\r\n\r\n      todo.setACL(acl);\r\n  \r\n      todo.save().then(function (response) {\r\n        successFn.call(null, response.id)\r\n      }, function (error) {\r\n        errorFn && errorFn.call(null, error)\r\n      });\r\n  \r\n    },\r\n    update({id, title, status, deleted}, successFn, errorFn){\r\n      // 文档 https://leancloud.cn/docs/leanstorage_guide-js.html#更新对象\r\n      let todo = AV.Object.createWithoutData('Todo', id)\r\n      title !== undefined && todo.set('title', title)\r\n      status !== undefined && todo.set('status', status)\r\n      deleted !== undefined && todo.set('deleted', deleted)\r\n      // 为什么我要像上面那样写代码？\r\n      // 考虑如下场景\r\n      // update({id:1, title:'hi'})\r\n      // 调用 update 时，很有可能没有传 status 和 deleted\r\n      // 也就是说，用户只想「局部更新」\r\n      // 所以我们只 set 该 set 的\r\n      // 那么为什么不写成 title && todo.set('title', title) 呢，为什么要多此一举跟 undefined 做对比呢？\r\n      // 考虑如下场景\r\n      // update({id:1, title: '', status: null}}\r\n      // 用户想将 title 和 status 置空，我们要满足\r\n      todo.save().then((response) => {\r\n        successFn && successFn.call(null)\r\n      }, (error) => errorFn && errorFn.call(null, error))\r\n    },\r\n    destroy(todoId, successFn, errorFn){\r\n       // 我们不应该删除数据，而是将数据标记为 deleted\r\n       TodoModel.update({id: todoId, deleted: true}, successFn, errorFn)\r\n    }\r\n}\r\n  \r\n  export function signUp (email, username, password, successFn, errorFn) {\r\n    // 新建 AVUser 对象实例\r\n var user = new AV.User()\r\n // 设置用户名\r\n user.setUsername(username)\r\n // 设置密码\r\n user.setPassword(password)\r\n // 设置邮箱\r\n user.setEmail(email)\r\n\r\n user.signUp().then(function (loginedUser) {\r\n   let user = getUserFromAVUser(loginedUser)\r\n   successFn.call(null, user)\r\n }, function (error) {\r\n   errorFn.call(null, error)\r\n })\r\n\r\n return undefined\r\n\r\n}\r\n\r\nexport function signIn (username, password, successFn, errorFn) {\r\n  AV.User.logIn(username, password).then(function (loginedUser) {\r\n    let user = getUserFromAVUser(loginedUser)\r\n    successFn.call(null, user)\r\n  }, function (error) {\r\n    errorFn.call(null, error)\r\n  })\r\n}\r\nexport function getCurrentUser () {\r\n  let user = AV.User.current()\r\n  if (user) {\r\n    return getUserFromAVUser(user)\r\n  } else {\r\n    return null\r\n  }\r\n}\r\nexport function signOut () {\r\n  AV.User.logOut()\r\n  return undefined\r\n}\r\n\r\nexport function sendPasswordResetEmail (email, successFn, errorFn) {\r\n  AV.User.requestPasswordReset(email).then(function (success) {\r\n    successFn.call()\r\n  }, function (error) {\r\n    errorFn.call(null, error)\r\n  })\r\n}\r\n\r\n\r\nfunction getUserFromAVUser (AVUser) {\r\n return {\r\n   id: AVUser.id,\r\n   ...AVUser.attributes\r\n  }\r\n}","import React, {Component} from 'react';\r\n\r\nexport default class ForgotPasswordForm extends Component {\r\n  render () {\r\n    return (\r\n      <div className=\"forgotPassword\">\r\n        <h3>\r\n          重置密码\r\n        </h3>\r\n        <form className=\"forgotPassword\" onSubmit={this.props.onSubmit}> {/* 登录*/}\r\n          <div className=\"row\">\r\n            <label>邮箱</label>\r\n            <input type=\"text\" value={this.props.formData.email}\r\n              onChange={this.props.onChange.bind(null, 'email')}/>\r\n          </div>\r\n          <div className=\"row actions\">\r\n            <button type=\"submit\">发送重置邮件</button>\r\n            <a href=\"/#\" onClick={this.props.onSignIn}>返回登录</a>\r\n          </div>\r\n        </form>\r\n      </div>\r\n    )\r\n  }\r\n}","import React from 'react';\r\nexport default function (props) {\r\n  return (\r\n    <form className=\"signUp\" onSubmit={props.onSubmit.bind(this)}> {/* 注册*/}\r\n      <div className=\"row\">\r\n        <label>邮箱</label>\r\n        <input type=\"text\" value={props.formData.email}\r\n          onChange={props.onChange.bind(null, 'email')}/>\r\n      </div>\r\n      <div className=\"row\">\r\n        <label>用户名</label>\r\n        <input type=\"text\" value={props.formData.username}\r\n          onChange={props.onChange.bind(null, 'username')}/>\r\n        {/* bind 不仅可以绑定 this，还可以绑定第一个参数 */}\r\n      </div>\r\n      <div className=\"row\">\r\n        <label>密码</label>\r\n        <input type=\"password\" value={props.formData.password}\r\n          onChange={props.onChange.bind(null, 'password')}/>\r\n      </div>\r\n      <div className=\"row actions\">\r\n        <button type=\"submit\">注册</button>\r\n      </div>\r\n    </form>\r\n  )\r\n}","import React from 'react';\r\nexport default function (props) {\r\n  return (\r\n    <form className=\"signIn\" onSubmit={props.onSubmit}> {/* 登录*/}\r\n      <div className=\"row\">\r\n        <label>用户名</label>\r\n        <input type=\"text\" value={props.formData.username}\r\n          onChange={props.onChange.bind(null, 'username')}/>\r\n      </div>\r\n      <div className=\"row\">\r\n        <label>密码</label>\r\n        <input type=\"password\" value={props.formData.password}\r\n          onChange={props.onChange.bind(null, 'password')}/>\r\n      </div>\r\n      <div className=\"row actions\">\r\n        <button type=\"submit\">登录</button>\r\n        <a href=\"/#\" onClick={props.onForgotPassword}>忘记密码了？</a>\r\n      </div>\r\n    </form>\r\n  )\r\n}","import React, {Component} from 'react';\r\nimport SignUpForm from './SignUpForm'\r\nimport SignInForm from './SignInForm'\r\n\r\nexport default class SignInOrSignUp extends Component {\r\n  constructor (props) {\r\n    super(props)\r\n    this.state = {\r\n      selected: 'signUp'\r\n    }\r\n  }\r\n\r\n  switch (e) {\r\n    this.setState({\r\n      selected: e.target.value\r\n    })\r\n  }\r\n\r\n  render () {\r\n    return (\r\n      <div className=\"signInOrSignUp\">\r\n        <nav>\r\n          <label>\r\n            <input type=\"radio\" value=\"signUp\"\r\n              checked={this.state.selected === 'signUp'}\r\n              onChange={this.switch.bind(this)}\r\n            /> 注册</label>\r\n          <label>\r\n            <input type=\"radio\" value=\"signIn\"\r\n              checked={this.state.selected === 'signIn'}\r\n              onChange={this.switch.bind(this)}\r\n            /> 登录</label>\r\n        </nav>\r\n        <div className=\"panes\">\r\n          {this.state.selected === 'signUp' ?\r\n            <SignUpForm formData={this.props.formData}\r\n              onSubmit={this.props.onSignUp}\r\n              onChange={this.props.onChange}\r\n            />\r\n            : null}\r\n          {this.state.selected === 'signIn' ?\r\n            <SignInForm formData={this.props.formData}\r\n              onChange={this.props.onChange}\r\n              onSubmit={this.props.onSignIn}\r\n              onForgotPassword={this.props.onForgotPassword}\r\n            />\r\n            : null}\r\n        </div>\r\n      </div>\r\n    )\r\n  }\r\n}","import React, { Component } from 'react';\r\nimport './UserDialog.css';\r\nimport {signUp, signIn, sendPasswordResetEmail} from './leanCloud'\r\nimport ForgotPasswordForm from './ForgotPasswordForm'\r\nimport SignInOrSignUp from './SignInOrSignUp'\r\nexport default class UserDialog extends Component{\r\n    constructor(props){\r\n        super(props)\r\n        this.state = {\r\n            selectedTab: 'signInOrSignUp', // 'forgotPassword'\r\n            formData: {\r\n                email: '',\r\n              username: '',\r\n              password: '',\r\n            }\r\n        }\r\n      }\r\n      signUp(e){\r\n        e.preventDefault()\r\n        let {email, username, password} = this.state.formData\r\n        let success = (user)=>{\r\n            this.props.onSignUp.call(null, user)\r\n        }\r\n        let error = (error)=>{\r\n            switch(error.code){\r\n                case 202:\r\n                  alert('用户名已被占用')\r\n                  break\r\n                default:\r\n                  alert(error)\r\n                  break\r\n              }\r\n        }\r\n        signUp(email, username, password, success, error)\r\n      }\r\n      signIn(e){\r\n        e.preventDefault()\r\n        let {username, password} = this.state.formData\r\n        let success = (user)=>{\r\n          this.props.onSignIn.call(null, user)\r\n        }\r\n        let error = (error)=>{\r\n            switch(error.code){\r\n                case 210:\r\n                  alert('用户名与密码不匹配')\r\n                  break\r\n                default:\r\n                  alert(error)\r\n                  break\r\n              }\r\n        }\r\n        signIn(username, password, success, error)\r\n      }\r\n      changeFormData(key, e){\r\n        let stateCopy = JSON.parse(JSON.stringify(this.state))  // 用 JSON 深拷贝\r\n        stateCopy.formData[key] = e.target.value\r\n        this.setState(stateCopy)\r\n      }\r\n  render(){\r\n    return (\r\n      <div className=\"UserDialog-Wrapper\">\r\n        <div className=\"UserDialog\">\r\n        {\r\n            this.state.selectedTab === 'signInOrSignUp' ?\r\n              <SignInOrSignUp\r\n                formData={this.state.formData}\r\n                onSignIn={this.signIn.bind(this)}\r\n                onSignUp={this.signUp.bind(this)}\r\n                onChange={this.changeFormData.bind(this)}\r\n                onForgotPassword={this.showForgotPassword.bind(this)}\r\n              /> :\r\n            <ForgotPasswordForm\r\n              formData={this.state.formData}\r\n              onSubmit={this.resetPassword.bind(this)}\r\n              onChange={this.changeFormData.bind(this)}\r\n              onSignIn={this.returnToSignIn.bind(this)}\r\n              />\r\n          }\r\n        </div>\r\n      </div>\r\n    )\r\n  }\r\n  showForgotPassword(){\r\n    let stateCopy = JSON.parse(JSON.stringify(this.state))\r\n    stateCopy.selectedTab = 'forgotPassword'\r\n    this.setState(stateCopy)\r\n  }\r\n  returnToSignIn(){\r\n    let stateCopy = JSON.parse(JSON.stringify(this.state))\r\n    stateCopy.selectedTab = 'signInOrSignUp'\r\n    this.setState(stateCopy)\r\n  }\r\n  resetPassword(e){\r\n\r\n    e.preventDefault()\r\n    sendPasswordResetEmail(this.state.formData.email)    \r\n  }\r\n}","import React from 'react';\nimport './App.css';\nimport TodoInput from './TodoInput';\nimport TodoItem from './TodoItem';\nimport 'normalize.css';\nimport './reset.css';\nimport UserDialog from './UserDialog';\nimport {getCurrentUser, signOut, TodoModel} from './leanCloud'\n\nclass App extends React.Component{\n  constructor(props){\n    super(props)\n    this.state = {\n      user: getCurrentUser() || {},\n      newTodo: '',\n      todoList: []\n    }\n    let user = getCurrentUser()\n    if (user) {\n      TodoModel.getByUser(user, (todos) => {\n        let stateCopy = JSON.parse(JSON.stringify(this.state))\n        stateCopy.todoList = todos\n        this.setState(stateCopy)\n      })\n    }\n  }\n  render(){\n    let todos = this.state.todoList\n      .filter((item)=> !item.deleted)\n      .map((item,index)=>{\n      return (\n        <li key={index}>\n          <TodoItem todo={item} onToggle={this.toggle.bind(this)}\n            onDelete={this.delete.bind(this)}/>\n        </li>\n      )\n    })\n   \n\n    return (\n      <div className=\"App\">\n        <h1 className=\"title\">{this.state.user.username||'我'}的待办\n          {this.state.user.id ? <button onClick={this.signOut.bind(this)}>登出</button> : null}\n        </h1>\n       <div className=\"inputWrapper\">\n       <TodoInput content={this.state.newTodo}\n            onChange={this.changeTitle.bind(this)}\n            onSubmit={this.addTodo.bind(this)} />\n       </div>\n       <ol className=\"todoList\">\n       {todos}\n       </ol>\n       {this.state.user.id ? \n          null : \n          <UserDialog \n          onSignUp={this.onSignUpOrSignIn.bind(this)}\n          onSignIn={this.onSignUpOrSignIn.bind(this)}/>}\n      </div>\n    )\n  }\n  signOut(){\n    signOut()\n    let stateCopy = JSON.parse(JSON.stringify(this.state))\n    stateCopy.user = {}\n    this.setState(stateCopy)\n  }\n  onSignUpOrSignIn(user){\n    let stateCopy = JSON.parse(JSON.stringify(this.state))\n    stateCopy.user = user\n    this.setState(stateCopy)\n  }\n  componentDidUpdate(){\n    \n  }\n  toggle(e, todo){\n    let oldStatus = todo.status\n    todo.status = todo.status === 'completed' ? '' : 'completed'\n    TodoModel.update(todo, () => {\n      this.setState(this.state)\n    }, (error) => {\n      todo.status = oldStatus\n      this.setState(this.state)\n    }) \n  }\n  changeTitle(event){\n    this.setState({\n      newTodo: event.target.value,\n      todoList: this.state.todoList\n    })\n  }\n  addTodo(event){\n    let newTodo = {\n      \n      title: event.target.value,\n      status: '',\n      deleted: false\n    }\n    TodoModel.create(newTodo, (id) => {\n      newTodo.id = id\n      this.state.todoList.push(newTodo)\n      this.setState({\n        newTodo: '',\n        todoList: this.state.todoList\n      })\n    }, (error) => {\n      console.log(error)\n    })\n  }\n  delete(event, todo){\n    TodoModel.destroy(todo.id, () => {\n      todo.deleted = true\n      this.setState(this.state)\n    })\n  }\n}\n\nexport default App;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport App from './App';\n\nlet div = document.getElementById('root')\nReactDOM.render(<App />, div);\n"],"sourceRoot":""}